<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Estate Plan</title>

<style>
:root{
  --jam-dark:#2b1417;
  --jam-mid:#4a1f26;
  --paper:#ffffff;
  --border:#d2d6da;
  --heading:#2f4f4f;
  --muted:#6b7280;
  --soft:#f7f8fa;
}

/* ================= SCREEN ================= */
body{
  margin:0;
  font-family:"Times New Roman", Georgia, serif;
  font-size:18px;
  line-height:1.6;
  background:radial-gradient(circle at top, var(--jam-mid), var(--jam-dark));
  color:#1f2933;
}

.container{
  max-width:1150px;
  margin:50px auto;
  padding:48px 36px 140px;
  background:var(--paper);
  border-radius:18px;
  box-shadow:0 22px 50px rgba(0,0,0,0.35);
}

h1{
  text-align:center;
  margin:0;
  font-size:36px;
  color:var(--heading);
}

.subtitle{
  text-align:center;
  font-size:16px;
  color:var(--muted);
  margin:10px 0 0;
}

.toolbar{
  display:flex;
  justify-content:center;
  gap:12px;
  margin:26px 0 22px;
  flex-wrap:wrap;
}

button{
  padding:12px 18px;
  font-family:inherit;
  font-size:16px;
  border-radius:8px;
  border:1px solid var(--border);
  background:#f9fafb;
  cursor:pointer;
}

button:hover{ background:#eef2f5; }

section{
  border:1px solid var(--border);
  border-radius:12px;
  margin-bottom:22px;
  background:#fff;
}

.section-header{
  padding:20px 24px;
  border-bottom:1px solid var(--border);
}

.section-header h2{
  margin:0;
  font-size:24px;
  color:var(--heading);
}

.section-content{
  padding:24px;
}

.grid-2{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:16px;
}
@media(max-width:900px){
  .grid-2{ grid-template-columns:1fr; }
}

input, textarea, select{
  width:100%;
  padding:16px;
  margin-bottom:18px;
  border-radius:10px;
  border:1px solid var(--border);
  background:#fafafa;
  font-family:inherit;
  font-size:18px;
  box-sizing:border-box;
}

.large-note{ min-height:420px; }

/* ================= PRINT ================= */
.print-only{ display:none; }

.print-page{
  padding:20mm 20mm 26mm;
  page-break-after:always;
}

.print-text{
  white-space:pre-wrap;
  font-size:14pt;
  line-height:1.65;
}

@media print{
  body{ background:#fff; }
  .container{ display:none !important; }
  .print-only{ display:block !important; }

  @page{ margin:20mm 20mm 26mm; }

  footer{
    position:fixed;
    bottom:8mm;
    left:0;
    right:0;
    text-align:center;
    font-size:12px;
    color:#555;
  }

  footer:after{
    content:"Page " counter(page);
  }
}
</style>
</head>

<body>

<!-- ================= PRINT: COVER ================= -->
<div class="print-only print-page">
  <h1 style="text-align:center;margin-top:50mm;">My Estate Plan</h1>
  <p style="text-align:center;">
    Prepared for: <span id="coverName">—</span><br>
    Jurisdiction: <span id="coverCountry">—</span><br>
    Date: <span id="coverDate">—</span><br>
    Version: 1.0
  </p>
  <p style="text-align:center;font-size:14px;color:#555;">
    This document is a personal planning record only and is not a legal will.
  </p>
</div>

<!-- ================= PRINT: TOC ================= -->
<div class="print-only print-page">
  <h2>Table of Contents</h2>
  <ol id="tocList"></ol>
</div>

<!-- ================= PRINT: FAMILY SUMMARY ================= -->
<div class="print-only print-page">
  <h2>What To Do First</h2>
  <ol>
    <li>Do not rush. Take time.</li>
    <li>Locate important documents.</li>
    <li>Contact the executor.</li>
    <li>Secure property, pets, and valuables.</li>
    <li>Do not distribute assets early.</li>
    <li>Seek professional advice.</li>
  </ol>
  <h3>Family Notes</h3>
  <div class="print-text" id="familyNotesPrint">—</div>
</div>

<footer class="print-only">My Estate Plan · </footer>

<!-- ================= SCREEN ================= -->
<div class="container" id="screenDoc">

<h1>My Estate Plan</h1>
<p class="subtitle">Personal planning record · Not a legal document</p>

<div class="toolbar">
  <button onclick="window.print()">Print / Save PDF</button>
  <button onclick="exportWord()">Download Word</button>
</div>

<section data-section>
  <div class="section-header"><h2>Personal Information</h2></div>
  <div class="section-content">
    <div class="grid-2">
      <input id="name" data-key="name" placeholder="Full legal name">
      <input data-key="dob" placeholder="Date of birth">
    </div>
    <input data-key="address" placeholder="Address">
    <div class="grid-2">
      <input data-key="phone" placeholder="Telephone">
      <input data-key="email" placeholder="Email">
    </div>
    <select id="country" data-key="country"></select>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Executor</h2></div>
  <div class="section-content">
    <input data-key="executor" placeholder="Executor name">
    <textarea class="large-note" data-key="executor_notes" placeholder="Executor instructions"></textarea>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Important Documents</h2></div>
  <div class="section-content">
    <textarea class="large-note" data-key="documents" placeholder="Where documents are stored"></textarea>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Assets</h2></div>
  <div class="section-content">
    <textarea class="large-note" data-key="assets" placeholder="List assets"></textarea>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Final Wishes</h2></div>
  <div class="section-content">
    <textarea class="large-note" data-key="final_wishes" placeholder="Final wishes"></textarea>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Family “What To Do First” Notes</h2></div>
  <div class="section-content">
    <textarea id="familyNotes" class="large-note" data-key="family_notes"
      placeholder="Keys, pets, urgent contacts, immediate instructions"></textarea>
  </div>
</section>

</div>

<script>
/* ================= DATA ================= */
const STORE="estate_plan_complete_final";
const fields=[...document.querySelectorAll("[data-key]")];

/* ================= COUNTRIES ================= */
const countries=[
"Select country",
"United States","Canada","United Kingdom","Australia","New Zealand",
"France","Germany","Italy","Spain","Netherlands","Sweden","Norway","Finland",
"Japan","China","India","Brazil","Mexico","South Africa","Other"
];

const countrySel=document.getElementById("country");
countries.forEach(c=>{
  const o=document.createElement("option");
  o.value=c; o.textContent=c;
  countrySel.appendChild(o);
});

/* ================= SAVE / LOAD ================= */
function save(){
  const d={};
  fields.forEach(f=>d[f.dataset.key]=f.value||"");
  localStorage.setItem(STORE,JSON.stringify(d));
}

function load(){
  const raw=localStorage.getItem(STORE);
  if(!raw) return;
  try{
    const d=JSON.parse(raw);
    fields.forEach(f=>f.value=d[f.dataset.key]||"");
  }catch(e){}
}
fields.forEach(f=>f.addEventListener("input",save));
load();

/* ================= PRINT ================= */
function buildTOC(){
  const toc=document.getElementById("tocList");
  toc.innerHTML="";
  document.querySelectorAll("[data-section] h2").forEach(h=>{
    const li=document.createElement("li");
    li.textContent=h.textContent;
    toc.appendChild(li);
  });
}

window.addEventListener("beforeprint",()=>{
  document.getElementById("coverName").textContent=document.getElementById("name").value||"—";
  document.getElementById("coverCountry").textContent=countrySel.value||"—";
  document.getElementById("coverDate").textContent=new Date().toLocaleDateString();
  document.getElementById("familyNotesPrint").textContent=document.getElementById("familyNotes").value||"—";
  buildTOC();
});

/* ================= WORD EXPORT ================= */
function exportWord(){
  const clone=document.getElementById("screenDoc").cloneNode(true);
  clone.querySelector(".toolbar").remove();
  clone.querySelectorAll("input,textarea,select").forEach(el=>{
    const div=document.createElement("div");
    div.style.whiteSpace="pre-wrap";
    div.textContent=el.value||"—";
    el.replaceWith(div);
  });

  const html=`<html><head><meta charset="UTF-8"></head>
  <body style="font-family:Times New Roman,Georgia,serif;">${clone.outerHTML}</body></html>`;

  const blob=new Blob(['\ufeff',html],{type:"application/msword"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="My_Estate_Plan.doc";
  a.click();
}
</script>

</body>
</html>
