<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Estate Plan</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --jam-dark:#2b1417;
  --jam-mid:#4a1f26;
  --paper:#ffffff;
  --border:#d2d6da;
  --heading:#2f4f4f;
  --muted:#6b7280;
}

/* ===== SCREEN ===== */
body{
  margin:0;
  font-family:"Times New Roman", Georgia, serif;
  background:radial-gradient(circle at top, var(--jam-mid), var(--jam-dark));
  color:#1f2933;
}

.container{
  max-width:1100px;
  margin:50px auto;
  padding:40px 30px 120px;
  background:var(--paper);
  border-radius:16px;
  box-shadow:0 20px 45px rgba(0,0,0,0.35);
}

h1,h2{ color:var(--heading); margin-top:0; }

.toolbar{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:20px 0;
  flex-wrap:wrap;
}

button{
  padding:9px 14px;
  font-family:inherit;
  font-size:14px;
  border-radius:6px;
  border:1px solid var(--border);
  background:#f9fafb;
  cursor:pointer;
}

section{
  border:1px solid var(--border);
  border-radius:10px;
  margin-bottom:18px;
  background:#fff;
}

.section-header{
  padding:16px 20px;
  border-bottom:1px solid var(--border);
}

.section-content{ padding:20px; }

textarea, input{
  width:100%;
  padding:10px;
  margin-bottom:12px;
  border-radius:6px;
  border:1px solid var(--border);
  background:#fafafa;
  font-family:inherit;
}

.large-note{ min-height:200px; }

/* ===== PRINT ===== */
.print-only{ display:none; }

@media print{
  body{ background:#fff; }
  .container, .toolbar{ display:none; }
  .print-only{ display:block; }

  @page{
    margin:20mm;
  }

  footer{
    position:fixed;
    bottom:10mm;
    left:0;
    right:0;
    text-align:center;
    font-size:11px;
    color:#555;
  }

  footer:after{
    content:"Page " counter(page);
  }
}

/* Word export formatting */
.word h1{ font-size:26px; }
.word h2{ font-size:18px; margin-top:20px; }
.word p, .word div{ font-size:12pt; }
</style>
</head>

<body>

<!-- ===== PRINT COVER ===== -->
<div class="print-only">
  <h1 style="text-align:center;margin-top:100px;">My Estate Plan</h1>
  <p style="text-align:center;">
    Prepared for: <span id="coverName">—</span><br>
    Jurisdiction: <span id="coverCountry">—</span><br>
    Date: <span id="coverDate">—</span>
  </p>
  <div style="page-break-after:always;"></div>

  <!-- TOC -->
  <h2>Table of Contents</h2>
  <ol id="toc"></ol>
  <div style="page-break-after:always;"></div>

  <!-- FAMILY SUMMARY -->
  <h2>What To Do First</h2>
  <ol>
    <li>Do not rush. Take time.</li>
    <li>Locate important documents.</li>
    <li>Contact the executor.</li>
    <li>Secure property, pets, and valuables.</li>
    <li>Do not distribute assets prematurely.</li>
    <li>Seek professional advice.</li>
  </ol>

  <h3>Family Notes</h3>
  <div id="familyNotesPrint"></div>

  <div style="page-break-after:always;"></div>
</div>

<footer class="print-only">
  My Estate Plan ·
</footer>

<!-- ===== SCREEN ===== -->
<div class="container" id="doc">

<h1>My Estate Plan</h1>

<div class="toolbar">
  <button onclick="window.print()">Print / PDF</button>
  <button onclick="exportWord()">Download Word</button>
</div>

<section data-section>
  <div class="section-header"><h2>Personal Information</h2></div>
  <div class="section-content">
    <input id="name" placeholder="Full legal name">
    <input id="country" placeholder="Country / jurisdiction">
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Executor</h2></div>
  <div class="section-content">
    <input placeholder="Executor name">
    <textarea class="large-note"></textarea>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Assets</h2></div>
  <div class="section-content">
    <textarea class="large-note"></textarea>
  </div>
</section>

<section data-section>
  <div class="section-header"><h2>Final Wishes</h2></div>
  <div class="section-content">
    <textarea class="large-note"></textarea>
  </div>
</section>

<section>
  <div class="section-header"><h2>Family “What To Do First” – Notes</h2></div>
  <div class="section-content">
    <textarea id="familyNotes" class="large-note"
      placeholder="Keys, pets, urgent contacts, immediate instructions for family"></textarea>
  </div>
</section>

</div>

<script>
/* PREPARE PRINT */
window.addEventListener("beforeprint",()=>{
  document.getElementById("coverName").textContent =
    document.getElementById("name").value || "—";
  document.getElementById("coverCountry").textContent =
    document.getElementById("country").value || "—";
  document.getElementById("coverDate").textContent =
    new Date().toLocaleDateString();

  const toc=document.getElementById("toc");
  toc.innerHTML="";
  document.querySelectorAll("[data-section] h2").forEach(h=>{
    const li=document.createElement("li");
    li.textContent=h.textContent;
    toc.appendChild(li);
  });

  document.getElementById("familyNotesPrint").textContent =
    document.getElementById("familyNotes").value || "";
});

/* WORD EXPORT */
function exportWord(){
  const content = document.getElementById("doc").innerHTML;
  const html = `
  <html><head><meta charset="UTF-8"></head>
  <body class="word">${content}</body></html>`;

  const blob = new Blob(
    ['\ufeff', html],
    { type: 'application/msword' }
  );

  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "My_Estate_Plan.doc";
  a.click();
}
</script>

</body>
</html>
